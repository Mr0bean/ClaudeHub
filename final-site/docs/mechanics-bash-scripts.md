---
title: "Bash 脚本"
---

# Bash 脚本

Claude Code 在您的开发环境中运行，可以可靠地创建简单到中等复杂度的 bash 脚本来自动化各种流程。这些脚本特别有用，因为可以使用标准系统工具对它们进行迭代并测试功能。

在我使用 Claude Code 的过程中，我观察到最慢的过程之一是编辑/写入操作。

* * *

**Claude 对延迟的解释**

-   **工具调用开销**：每次编辑都需要单独的 API 调用，存在网络延迟
-   **安全验证**：每个操作在执行前都需要确认和错误检查
-   **顺序处理**：文件操作是逐个进行的，而不是并行批处理
-   **上下文切换**：跨多个文件管理状态会产生认知开销
-   **令牌处理**：大型编辑会消耗大量的输入/输出令牌处理时间

* * *

* * *

我的解决方案是创建一个 Bash 脚本，异步执行多个写入/编辑操作，将多个工具调用往返减少为单次执行。该脚本接受一个 JSON 输入文件，定义目标文件的绝对文件路径、要创建或编辑的特定文件名、需要修改的确切行号，以及应该替换或插入到这些位置的新内容。

然后更新我的 `CLAUDE.md` 以通知 Claude 系统的存在，这样我就可以在必要时选择使用它。

使用 bash 脚本执行多个写入操作在令牌效率上很高，但不如基于任务/代理的编排快速（尽管基于任务/代理的编排在令牌成本上更高）。

实施这个机制可以显著加速依赖写入/编辑的工作流程，具体取决于您需要执行的写入/编辑操作的数量及其复杂性。

* * *

* * *

**机制优势：**

-   **减少 API 开销**：单个工具调用而不是多个单独的编辑操作
-   **批处理**：在一次执行中同时处理数十个文件
-   **令牌效率**：与顺序编辑相比，总体令牌消耗更低
-   **异步执行**：文件并行处理而不是顺序处理
-   **JSON 驱动的工作流**：用于复杂操作的结构化、可预测的输入格式
-   **可重用的自动化**：脚本可以保存并重用于未来的类似任务
-   **减少网络延迟**：消除 Claude 和您的系统之间的多次往返

##### 基准测试

考虑让 Claude 构建一个基于 Bash 的基准测试工具，可以测量和比较不同的速度优化机制。


* * *

**另请参阅**：[任务代理工具](/mechanics-task-agent-tools.html)|[Git Clone 只是开始](/mechanics-git-clone-is-just-the-beginning.html)|[钩子](/mechanics-hooks.html)

