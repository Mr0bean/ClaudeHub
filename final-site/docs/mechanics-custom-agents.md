---
title: "自定义代理 | Claude Hub"
---

# 自定义代理 | Claude Hub

`子代理`一直是 Claude Code 最大的优势之一。然而，期望用户知道何时手动调用它们并记住要赋予它们什么专业知识，这总是阻碍了普通用户使用该功能。现在不再如此了...

`自定义代理`是可用于解决特定任务的专门代理。它们**由 Claude 自动调用**，调用方式类似于`工具`的自动调用！

这种方法带来了难以置信的潜力！鉴于 MCP 工具生态系统已经变得如此可靠和完善，我设想一个繁荣的未来，我们可以协作构建、分享和交换代理。如果你有很酷的代理或想要迭代现有的代理，请务必前往 [r/ClaudeAI](https://www.reddit.com/r/ClaudeAI/)。

与传统的`子代理`不同，它们拥有自己的`自定义系统提示`、工具和与其`委派代理`分离的上下文窗口。`自定义代理`被设计为专门化、隔离和高效的。它们的配置原生集成在 Claude Code 中，有效地消除了对第三方角色编排工具的需求。

* * *

* * *

### 游戏规则将永远改变[​](#the-game-will-never-be-the-same "Direct link to 游戏规则将永远改变")

**自动委派** - 这种机制之所以强大且可扩展，是因为任务会自动委派给专门的隔离代理。集成过程是无缝的，并建立在 Claude 使用工具时的可靠性之上。Claude 根据你请求中的任务描述、代理配置中的描述字段、当前上下文和可用工具来委派任务。

**无需手动调用** - 你不再需要记住使用哪个角色`子代理`或何时使用。Claude 会智能地将任务路由到适当的专家，就像它自动选择正确的工具一样。然而，你需要在你的设置中测试任务路由的可靠性，特别是如果你用太多`自定义代理`选项淹没 Claude 的话。

### 核心优势[​](#core-benefits "Direct link to 核心优势")

-   **独立的上下文窗口** - 每个`自定义代理`都在自己的上下文窗口中运行，与`委派代理`分离。这允许完成更大的任务，而不需要让`委派代理`关注每个细节，防止不同任务[污染上下文](/mechanics-poison-context-awareness.html)，同时保持峰值性能。
    
-   **专门的系统提示** - 单个`自定义代理`系统提示可以精确定义范围，避免继承冗余的上下文，从而保留有限的上下文窗口。
    
-   **角色特定的工具** - 代理可以配置特定的工具，通过只允许受信任的代理执行某些任务来帮助防止安全问题。特定代理可以在其角色上进行测试和评估可靠性。这种第一方级别的集成将[分离角色子代理](/mechanics-split-role-sub-agents.html)的概念提升到了新的水平！
    
-   **社区共享** - 一旦完善，`自定义代理`可以在项目之间、团队之间共享，甚至在 [r/ClaudeAI](https://www.reddit.com/r/ClaudeAI/) 中共享，创建一个不断发展的专门代理的协作生态系统。
    

* * *

* * *

### 快速入门指南[​](#quick-start-guide "Direct link to 快速入门指南")

`自定义代理`在 Claude Code [v1.0.60](/claude-code-changelog.html) 中引入

**1\. 打开自定义代理界面**

```bash
/agents

```

**2\. 选择"创建新代理"** 选择是创建项目级还是用户级`自定义代理`。

**3\. 定义你的代理**

-   **推荐**：先用 Claude 生成，然后自定义以使其成为你自己的
-   详细描述你的代理以及何时应该使用它
-   选择特定工具或留空以继承所有工具
-   编辑系统提示以定义角色、能力和方法
-   选择你的代理的颜色
-   审查你的`自定义代理`的配置

**4\. 保存并使用** 你的`自定义代理`现在可用了！Claude 会在适当的时候自动使用它，或者你可以显式调用它：`使用算法复杂度专家代理来分析这个函数。`

**文件格式**：

```bash
---

name: your-agent-name

description: 描述何时应该调用此代理

tools: tool1, tool2, tool3  # 可选 - 如果省略则继承所有工具

model: sonnet  # 可选 - sonnet、opus 或 haiku。如果省略则继承

---

你的代理系统提示放在这里。定义角色、能力

和解决问题的方法。包括具体说明、

最佳实践以及代理应遵循的任何约束。

```

* * *

* * *

### 基本用法[​](#basic-usage "Direct link to 基本用法")

**自动调用** - 一旦创建，你的`自定义代理`就会自动工作。Claude 会根据你的请求和代理的描述选择并使用适当的代理。

**手动调用** - 你也可以显式请求特定代理：

```bash
使用算法复杂度专家代理来分析这个函数。

```

**任务委派** - Claude 智能地将任务路由到专门的隔离代理，类似于它如何自动为不同操作选择工具。

* * *

* * *

### 配置[​](#configuration "Direct link to 配置")

`自定义代理`作为带有 YAML frontmatter 的 Markdown 文件存储在两个可能的位置：

| 类型 | 位置 | 范围 | 优先级 |
|------|------|------|--------|
| 项目代理 | `.claude/agents/` | 在当前项目中可用 | 最高 |
| 用户代理 | `~/.claude/agents/` | 在所有项目中可用 | 较低 |

当代理名称冲突时，项目级代理优先于用户级代理。

**配置字段**

| 字段 | 必需 | 描述 |
|------|------|------|
| name | 是 | 使用小写字母和连字符的唯一标识符 |
| description | 是 | 代理目的的自然语言描述 |
| tools | 否 | 特定工具的逗号分隔列表。如果省略，从主线程继承所有工具 |
| model | 否 | 此代理使用的模型：sonnet、opus 或 haiku。如果省略，继承模型 |

* * *

### 最佳实践[​](#best-practices "Direct link to 最佳实践")

-   **从 Claude 生成开始** - 用 Claude 生成你的初始代理，然后自定义以使其成为你自己的。
    
-   **关注点分离** - 就像编程一样，在你的`自定义代理`中更好地分离关注点会带来更好的性能、可维护性、可检查性和可共享性。
    
-   **提供示例** - 在你的系统提示中包含正面/负面示例。LLM 擅长模式识别和重复，所以一定要提供足够数量的不同实例。
    
-   **渐进式工具扩展** - 从为你的`自定义代理`精心定义的工具集开始，并在验证其行为并确定最佳性能所需的额外功能时逐步扩展工具范围。
    

* * *

* * *

### 社区愿景[​](#community-vision "Direct link to 社区愿景")

我对代理工作流的未来感到无比兴奋！我们都应该共同努力，完善各种代理的最佳实例并相互分享。由于用户不需要了解何时激活代理，这种自动委派使得这种倡议更加可行。

分享自定义代理就像复制单个 Markdown 文件一样简单。例如，为一个项目创建的 `code-reviewer.md` 代理可以立即与队友或社区共享：

```bash
---

name: code-reviewer

description: 专业代码审查专家。主动审查代码的质量、安全性和可维护性。在编写或修改代码后立即使用。

tools: Read, Grep, Glob, Bash

model: opus

---

你是一位高级代码审查员，确保代码质量和安全的高标准。

调用时：

1. 运行 git diff 查看最近的更改

2. 关注修改的文件

3. 立即开始审查

审查清单：

- 代码简单易读

- 函数和变量命名良好

- 没有重复代码

- 正确的错误处理

- 没有暴露的密钥或 API 密钥

- 实现了输入验证

- 良好的测试覆盖率

- 考虑了性能问题

- 分析了算法的时间复杂度

- 检查了集成库的许可证

按优先级组织反馈：

- 关键问题（必须修复）

- 警告（应该修复）

- 建议（考虑改进）

包括如何修复问题的具体示例。

```

你的目标应该是从不同领域构建一个经过实战检验的`自定义代理`综合集合，使你能够有效地处理任何任务。

**官方文档**：[子代理文档](https://docs.anthropic.com/en/docs/claude-code-sub-agents)

社区协作

自定义代理的真正力量通过社区共享和迭代而显现。基于他人的代理进行构建，分享你的专门创作，并为不断增长的经过实战检验的专家生态系统做出贡献。访问 [r/ClaudeAI](https://www.reddit.com/r/ClaudeAI/) 以协作发现、分享和完善代理。

令牌成本意识

每次自定义代理调用都会根据工具数量和配置复杂性产生可变的初始化成本。深思熟虑地设计你的[代理](/mechanics-agent-engineering.html)，确保它们提供足够的价值来证明这种开销是合理的，专注于从专用上下文和专业知识中受益的专门任务。

模型选择策略

这种新能力开辟了未探索的领域！虽然逻辑配对是有意义的（Haiku 用于简单任务，opus 用于复杂分析），但要交叉实验以发现令人惊讶的协同效应。

##### 专门化智能

自定义代理就像专门的团队成员 - 每个都有领域专业知识、特定工具和专注的职责。这创建了一个协作的 AI 环境，由合适的专家处理每项任务。


* * *

**另请参阅**：[任务代理工具](/mechanics-task-agent-tools.html) | [代理工程](/mechanics-agent-engineering.html) | [r/ClaudeAI](https://www.reddit.com/r/ClaudeAI/)
